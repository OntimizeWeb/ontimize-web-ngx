@use "sass:map";
@use 'fonts/poppins.scss';
@use 'styles/lite/layout.scss';
@use 'styles/default/typography/ontimize.scss'as ontimize-typography;
@use 'styles/default/addons/report-on-demand.scss';
@use '@angular/material'as mat;
@use 'styles/density.scss'as o-density;

$typography: ontimize-typography.$default-typography;

@mixin ontimize-theme-styles($theme-or-color-config) {

  $theme: map.get($theme-or-color-config, color);

  $primary: map.get($theme, primary);
  $accent: map.get($theme, accent);
  // $warn: map-get($theme, warn);
  $background: map.get($theme, background);
  $foreground: map.get($theme, foreground);
  $container-background: mat.get-color-from-palette($background, 'card');
  $border-radius: 2px;
  $button-line-height: 30px;
  $basic-padding-size: 8px;
  // $tabs-header-border: 1px solid mat.get-color-from-palette($foreground, divider);
  $tabs-header-border: none;
  $inactive-tab-opacity: .35;
  $font-size-title-container: 1;
  $fill-background-input: mat.get-color-from-palette($foreground, base, 0.1);
  $is-dark-theme: map.get($theme, is-dark);

  // $background-tab-active: mat.get-color-from-palette($background, 800);
  $background-tab-inactive-on-dark: #686868;
  $background-tab-inactive-on-light: #D7DDE0;
  $background-tab-inactive: if($is-dark-theme, $background-tab-inactive-on-dark, $background-tab-inactive-on-light);
  // $mat-font-family: 'Lato', sans-serif !default;
  @include report-on-demand.report-on-demand($theme-or-color-config);
  @include layout.layout-padding-margin();
  @include o-density.checkbox(20px, 16px, 16px);


  /* CONTAINER */
  .rounded-panel,
  .standalone-chart-container,
  .standalone-form-container .o-form-content-wrapper {
    background: $container-background;
    border-radius: $border-radius;
  }

  .standalone-chart-container {
    margin-top: 48px;
  }

  .standalone-form-container {
    .inner-form {
      padding: $basic-padding-size*2;
    }
  }

  /* APP SIDENAV */
  .o-app-sidenav {
    font-weight: 400;
    color: #aaaaaa;
  }

  /* USER INFO */
  o-app-header .o-app-header-title {
    font-weight: 700;
  }

  .o-app-header {
    background-color: $container-background;
  }

  /* FORM */
  .o-form-toolbar {
    .mat-toolbar {
      box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.24);
      background-color: mat.get-color-from-palette($background, background);
      border-radius: $border-radius;
      min-height: initial;
    }
  }

  /* TABS */
  .mat-mdc-tab-group {

    /* TODO(mdc-migration): The following rule targets internal classes of tabs that may no longer apply for the MDC version.*/
    .mat-tab-label,
    .mat-mdc-tab-link {
      opacity: .75;

      /* TODO(mdc-migration): The following rule targets internal classes of tabs that may no longer apply for the MDC version.*/
      &.mat-tab-label-active {
        opacity: .95;
      }
    }

    // Ontimize tabs
    &.o-tab-ontimize {
      >.mat-mdc-tab-header {
        border: none;

        /* TODO(mdc-migration): The following rule targets internal classes of tabs that may no longer apply for the MDC version.*/
        /* TODO(mdc-migration): The following rule targets internal classes of tabs that may no longer apply for the MDC version.*/
        /* TODO(mdc-migration): The following rule targets internal classes of tabs that may no longer apply for the MDC version.*/
        /* TODO(mdc-migration): The following rule targets internal classes of tabs that may no longer apply for the MDC version.*/
        .mat-tab-label-container .mat-tab-label {
          background: $background-tab-inactive;
          padding: 0;

          span.tab-label {
            text-overflow: clip;
            position: relative;

            span.gradient-layer {
              width: 12px;

              background: linear-gradient(to right, transparent, $background-tab-inactive 100%);
              height: 100%;
              position: absolute;
              right: 0;
            }
          }

          /* TODO(mdc-migration): The following rule targets internal classes of tabs that may no longer apply for the MDC version.*/
          /* TODO(mdc-migration): The following rule targets internal classes of tabs that may no longer apply for the MDC version.*/
          /* TODO(mdc-migration): The following rule targets internal classes of tabs that may no longer apply for the MDC version.*/
          &:not(.mat-tab-label-active) {
            &:not(:last-child) {

              /* TODO(mdc-migration): The following rule targets internal classes of tabs that may no longer apply for the MDC version.*/
              /* TODO(mdc-migration): The following rule targets internal classes of tabs that may no longer apply for the MDC version.*/
              +.mat-tab-label:not(.mat-tab-label-active) {

                /* TODO(mdc-migration): The following rule targets internal classes of tabs that may no longer apply for the MDC version.*/
                .mat-tab-label-content {
                  border-left: 1px solid mat.get-color-from-palette($foreground, divider);

                }
              }
            }
          }

          /* TODO(mdc-migration): The following rule targets internal classes of tabs that may no longer apply for the MDC version.*/
          .mat-tab-label-content {
            padding: 0 8px;
            width: 100%;
          }

          /* TODO(mdc-migration): The following rule targets internal classes of tabs that may no longer apply for the MDC version.*/
          &.mat-tab-label-active {
            background: $container-background;

            span.tab-label {
              span.gradient-layer {
                background: linear-gradient(to right, transparent, $container-background 100%);

              }
            }

          }
        }

        mat-ink-bar {
          display: none;
        }
      }

      /* TODO(mdc-migration): The following rule targets internal classes of tabs that may no longer apply for the MDC version.*/
      >.mat-tab-body-wrapper {
        background: $container-background;
        border-radius: $border-radius;
        border-top: $tabs-header-border;
        border-top-left-radius: initial;
      }
    }

    // All tabs
    &.mat-mdc-tab-group {

      /* TODO(mdc-migration): The following rule targets internal classes of tabs that may no longer apply for the MDC version.*/
      .mat-tab-body-wrapper {
        padding: $basic-padding-size;
      }
    }
  }

  /* BUTTON */
  button {

    &.mat-mdc-button,
    &.mat-mdc-unelevated-button,
    &.mat-mdc-icon-button,
    &.mat-mdc-raised-button,
    &.mat-mdc-outlined-button {
      border-radius: $border-radius;
    }
  }

  /* TABLE */
  .ontimize-table.o-table {
    font-weight: 400;

    .o-table-container {
      border: none;
      border-radius: $border-radius;
      box-sizing: border-box;

      /*Toolbar*/
      .o-table-toolbar {
        margin: 0 0 4px;
        padding-top: $basic-padding-size;
      }

      .o-table-menu {
        .o-table-option-active {
          background: mat.get-color-from-palette($foreground, divider);
        }
      }

      thead tr th {
        font-weight: 700;
      }

      tbody tr.even,
      thead tr {
        background-color: inherit;
      }

      /* TODO(mdc-migration): The following rule targets internal classes of checkbox that may no longer apply for the MDC version.*/
      tbody td.o-table-column-select-checkbox .mat-checkbox-inner-container .mat-checkbox-background,
      thead tr th.o-table-column-select-checkbox .mat-checkbox-inner-container .mat-checkbox-background {
        background-color: mat.get-color-from-palette($accent);
      }

      .mat-mdc-header-cell {
        font-weight: 700;
      }
    }

    .mat-mdc-paginator {
      background: inherit;
    }

    .mat-mdc-table {
      .mat-mdc-header-row .mat-mdc-header-cell {
        font-weight: 700;
      }
    }
  }

  .ontimize-table.o-table.o-table-fixed {
    .o-scrollable-container {
      height: 100%;
      overflow-y: auto;
    }
  }



  .mat-mdc-menu-panel.o-table-quickfilter-menu .mat-mdc-checkbox,
  .mat-mdc-menu-panel.o-search-input-menu .mat-mdc-checkbox {
    padding: 2px 0;
  }

}